(()=>{"use strict";var e={865:(e,n,t)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function i(e,n,t,r,o,i,s){try{var c=e[i](s),a=c.value}catch(e){return void t(e)}c.done?n(a):Promise.resolve(a).then(r,o)}function s(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var s=e.apply(n,t);function c(e){i(s,r,o,c,a,"next",e)}function a(e){i(s,r,o,c,a,"throw",e)}c(void 0)}))}}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){u(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function f(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(){return(l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}var v=t(26);e.exports=function(e,n,t){var i=l({},e);return new(function(){function e(n){var t=l({},n);!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._options=a({},t),this._events={},this._saveEvents=[],this.connect()}var i,c;return i=e,(c=[{key:"connect",value:function(){this.isBrowser?this.browserInstance():this.nodeInstance()}},{key:"browserInstance",value:function(){var e=this;this._ws=new WebSocket("ws://".concat(this._options.server)),this._ws.onopen=function(n){e.onOpen(n)},this._ws.onclose=function(n){e.onError(n)},this._ws.addEventListener("message",(function(n){e.onReceive(n)})),this._ws.addEventListener("error",(function(n){e.onError(n)}))}},{key:"nodeInstance",value:function(){this._ws=new v("ws://".concat(this._options.server)),this._ws.on("open",(function(e){this.onOpen(e)})),this._ws.on("message",(function(e){this.onReceive(e)})),this._ws.on("close",(function(e){this.onError(e)}))}},{key:"isFunction",value:function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},{key:"onOpen",value:function(){this.authenticate()}},{key:"event",value:function(e,n,t){this.isFunction(n)?(this._events[e]=n,this.send({header:{event:e},options:t})):this.send({header:{event:e},options:t,data:n})}},{key:"onReceive",value:function(e){try{var n=this.jsonParse(e.data);null!==n&&void 0!==n.header&&void 0!==n.header.event&&void 0!==this._events[n.header.event]?(0,this._events[n.header.event])(n.data):null!==n&&void 0!==n.header&&void 0!==n.header.id&&(window.document.cookie="_nl_id=".concat(n.header.id))}catch(e){console.error(e)}}},{key:"onError",value:function(e){var n=this;this._connected=!1,setTimeout(s(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.connected){e.next=5;break}return e.next=3,n.connect();case 3:e.next=5;break;case 5:case"end":return e.stop()}}),e)}))),7e3),t(),console.log(e)}},{key:"authenticate",value:function(){void 0===this._options.collactionKey&&console.error('Collection Key not "undefined'),this._connected=!0;var e={key:this._options.collactionKey},t=this.getCookie("_nl_id");t&&(e.id=t),this.send({header:e}),n(),this.resetEvents()}},{key:"resetEvents",value:function(){if(0!==this._saveEvents.length){var e,n=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return o(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,a=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return c=e.done,e},e:function(e){a=!0,s=e},f:function(){try{c||null==t.return||t.return()}finally{if(a)throw s}}}}(this._saveEvents);try{for(n.s();!(e=n.n()).done;){var t=e.value;this.event(t.name,t.action,t.options)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"send",value:function(e){this._ws.send(this.jsonStringify(e))}},{key:"jsonParse",value:function(e){try{return JSON.parse(e)}catch(e){throw null}}},{key:"jsonStringify",value:function(e){try{return JSON.stringify(e)}catch(e){throw null}}},{key:"getCookie",value:function(e){for(var n=e+"=",t=decodeURIComponent(window.document.cookie).split(";"),r=0;r<t.length;r++){for(var o=t[r];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(n))return o.substring(n.length,o.length)}return null}},{key:"isBrowser",get:function(){var e=!0;return"object"===("undefined"==typeof process?"undefined":r(process))&&"object"===r(process.versions)&&void 0!==process.versions.node&&(e=!1),e}}])&&f(i.prototype,c),e}())(a({},i))}},26:e=>{e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}},n={};!function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{}};return e[r](o,o.exports,t),o.exports}(865)})();