{"version":3,"file":"index.mjs","sources":["../src/shared/enum/ETransportCommand.ts","../src/shared/utils/Encodings.ts","../src/shared/utils/TransportCommands.ts","../src/shared/utils/transport.ts","../src/shared/models/Topic.ts","../src/shared/enum.ts","../src/shared/constants.ts","../src/client/NoLagClient.ts","../src/client/index.ts","../node_modules/ws/lib/constants.js","../node_modules/ws/lib/buffer-util.js","../node_modules/ws/lib/permessage-deflate.js","../node_modules/ws/lib/limiter.js","../node_modules/ws/lib/validation.js","../node_modules/ws/lib/receiver.js","../node_modules/ws/lib/sender.js","../node_modules/ws/lib/extension.js","../node_modules/ws/lib/websocket.js","../node_modules/ws/lib/event-target.js","../node_modules/ws/lib/subprotocol.js","../node_modules/ws/lib/websocket-server.js","../src/unifiedWebsocket/node.ts","../src/shared/utils/generateQueryString.ts","../src/api/controllers/tunnels/TunnelDevice.ts","../src/api/controllers/tunnels/TunnelPublish.ts","../src/api/controllers/tunnels/TunnelTopic.ts","../src/api/controllers/tunnels/TunnelApi.ts","../src/api/ApiTunnel.ts","../src/api/index.ts","../src/index.ts"],"sourcesContent":[null,null,null,null,null,null,null,null,null,"'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {Buffer[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst closeTimeout = 30 * 1000;\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 8 && version !== 13) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(server, req, socket, code, message) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message);\n  }\n}\n",null,null,null,null,null,null,null,null,null],"names":["ETransportCommand","ETransportCommandSeparator","stringToArrayBuffer","str","buf","ArrayBuffer","length","bufView","Uint8Array","strLen","i","charCodeAt","stringToBuffer","bufferToString","buffer","uint8ArrayToString","reduce","accumulator","index","String","fromCharCode","TransportCommands","commandArray","setCommand","command","commandAction","this","push","commandActionArray","Array","isArray","convertArray","convertStringNumberArray","commandActionBuffer","from","commandActions","map","action","ArraySeparator","flat","build","transportCommands","NqlTransport","encode","payload","separatorArray","Payload","transportCommandsUintArray","commandLength","byteLength","payloadOffset","payloadLength","payloadUintArray","tmp","set","decode","transport","totalTransportBytes","transportBufferViewer","payloadSeparatorIndex","indexOf","commands","slice","payloadStartIndex","extractedCommands","extractCommands","getCommand","hasSeparatorIndexes","commandActionUint8ArrayToString","item","join","commandActionUint8ArrayToStringArray","groupedUint8Array","tempGroup","forEach","uint8Array","Number","commandByteGroup","commandBeingAssigned","byte","Object","values","keys","key","Topic","connection","topicName","onReceiveCallback","identifiers","presence","tunnel","constructor","setConnection","saveIdentifiers","OR","subscribe","identifier","find","s","deleteSavedIdentifiers","identifierList","Identifier","Presence","AddAction","console","log","send","setPresence","_onReceiveMessage","data","onReceive","callbackFn","addIdentifiers","identifiersList","removeIdentifiers","DeleteAction","unsubscribe","publish","EConnectionStatus","EEnvironment","EEncoding","EVisibilityState","EAccessPermission","EStatus","ETopicType","ELoadBalanceType","CONSTANT","DefaultWsHost","DefaultApiHost","DefaultWsUrl","DefaultPort","DefaultWsProtocol","DefaultApiUrl","DefaultHttpProtocol","NoLagClient","host","authToken","wsInstance","protocol","url","deviceConnectionId","undefined","environment","deviceTokenId","defaultCheckConnectionInterval","defaultCheckConnectionTimeout","checkConnectionInterval","checkConnectionTimeout","reConnect","callbackOnOpen","callbackOnReceive","callbackOnClose","callbackOnError","connectionStatus","Idle","backpressureSendInterval","senderInterval","unifiedWebsocket","connectOptions","startSender","setInterval","sendTransport","shift","slowDownSender","backpressureInterval","clearInterval","addToBuffer","setReConnect","connect","initWebsocketConnection","Promise","resolve","reject","checkConnection","Connected","setTimeout","disconnect","close","onOpen","event","_onOpen","onMessage","_onReceive","onClose","_onClose","onError","_onError","authenticate","Connecting","Authenticate","Reconnect","callback","onReceiveMessage","decoded","InitConnection","Acknowledge","Error","Disconnected","Alert","presences","heartbeat","Tunnel","noLagClient","topics","heartbeatTimer","heartBeatInterval","visibilityState","Visible","callbackOnDisconnect","callbackOnReconnect","callbackOnReceivedError","options","disconnectOnNoVisibility","onVisibilityChange","startHeartbeat","stopHeartbeat","initiate","reconnect","document","addEventListener","async","Hidden","tunnelInstance","err","canReconnect","doReconnect","onDisconnect","onReconnect","onErrors","getTopic","removeTopicInstance","encodedBuffer","status","BINARY_TYPES","hasBlob","Blob","constants","EMPTY_BUFFER","Buffer","alloc","GUID","kForOnEventAttribute","Symbol","kListener","kStatusCode","kWebSocket","NOOP","require$$0","FastBuffer","species","_mask","source","mask","output","offset","_unmask","bufferUtilModule","exports","concat","list","totalLength","target","allocUnsafe","byteOffset","toArrayBuffer","toBuffer","readOnly","isBuffer","isView","unmask","process","env","WS_NO_BUFFER_UTIL","bufferUtil","require","e","zlib","require$$1","Limiter","kDone","kRun","limiter","concurrency","pending","Infinity","jobs","add","job","require$$2","require$$3","TRAILER","kPerMessageDeflate","kTotalLength","kCallback","kBuffers","kError","zlibLimiter","deflateOnData","chunk","inflateOnData","_maxPayload","RangeError","code","removeListener","reset","inflateOnError","_inflate","permessageDeflate","isServer","maxPayload","_options","_threshold","threshold","_isServer","_deflate","params","concurrencyLimit","extensionName","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","accept","configurations","normalizeParams","acceptAsServer","acceptAsClient","cleanup","offers","opts","accepted","response","value","num","isInteger","TypeError","decompress","fin","done","_decompress","result","compress","_compress","endpoint","windowBits","Z_DEFAULT_WINDOWBITS","createInflateRaw","zlibInflateOptions","on","write","flush","_readableState","endEmitted","createDeflateRaw","zlibDeflateOptions","Z_SYNC_FLUSH","isUtf8","_isValidUTF8","len","validationModule","isBlob","arrayBuffer","type","stream","toStringTag","isValidStatusCode","isValidUTF8","tokenChars","WS_NO_UTF_8_VALIDATE","Writable","PerMessageDeflate","require$$4","receiver","super","_allowSynchronousEvents","allowSynchronousEvents","_binaryType","binaryType","_extensions","extensions","_skipUTF8Validation","skipUTF8Validation","_bufferedBytes","_buffers","_compressed","_payloadLength","_fragmented","_masked","_fin","_opcode","_totalPayloadLength","_messageLength","_fragments","_errored","_loop","_state","_write","encoding","cb","startLoop","consume","n","dst","getInfo","getPayloadLength16","getPayloadLength64","getMask","getData","createError","compressed","haveLength","readUInt16BE","readUInt32BE","Math","pow","controlMessage","dataMessage","error","messageLength","fragments","emit","setImmediate","end","ErrorCtor","message","prefix","statusCode","errorCode","captureStackTrace","randomFillSync","applyMask","require$$5","kByteLength","maskBuffer","RANDOM_POOL_SIZE","randomPool","randomPoolPointer","Sender","socket","generateMask","_generateMask","_maskBuffer","_socket","_firstFragment","_queue","onerror","frame","dataLength","merge","skipMasking","opcode","rsv1","writeUInt16BE","writeUIntBE","enqueue","dispatch","sendFrame","ping","size","getBlobData","pong","perMessageDeflate","binary","blob","then","destroyed","nextTick","callCallbacks","dequeue","catch","_","Reflect","apply","cork","uncork","sender","dest","name","elem","extension","format","k","v","parse","header","create","paramName","mustUnescape","isEscaping","inQuotes","start","SyntaxError","replace","token","EventEmitter","https","http","net","tls","randomBytes","createHash","URL","require$$7","require$$8","Receiver","require$$9","require$$10","require$$11","require$$12","EventTarget","removeEventListener","kCode","kData","kMessage","kReason","kTarget","kType","kWasClean","Event","defineProperty","prototype","enumerable","CloseEvent","reason","wasClean","ErrorEvent","MessageEvent","handler","listener","listeners","wrapper","isBinary","toString","callListener","_closeFrameReceived","_closeFrameSent","once","thisArg","handleEvent","call","eventTarget","require$$13","require$$14","require$$15","kAborted","protocolVersions","readyStates","subprotocolRegex","WebSocket","address","protocols","_closeCode","_closeMessage","_closeTimer","_errorEmitted","_paused","_protocol","_readyState","CONNECTING","_receiver","_sender","_bufferedAmount","_redirects","initAsClient","_autoPong","autoPong","includes","bufferedAmount","_writableState","isPaused","onclose","onopen","onmessage","readyState","_url","setSocket","head","receiverOnConclude","receiverOnDrain","receiverOnError","receiverOnMessage","receiverOnPing","receiverOnPong","senderOnError","setNoDelay","unshift","socketOnClose","socketOnData","socketOnEnd","socketOnError","OPEN","emitClose","CLOSED","removeAllListeners","CLOSING","errorEmitted","setCloseTimer","msg","abortHandshake","_req","pause","sendAfterClose","resume","needDrain","terminate","destroy","websocket","protocolVersion","followRedirects","maxRedirects","socketPath","hostname","timeout","method","path","port","parsedUrl","href","isSecure","isIpcUrl","invalidUrlMessage","pathname","hash","emitErrorAndClose","defaultPort","request","protocolSet","Set","req","createConnection","tlsConnect","netConnect","startsWith","headers","Connection","Upgrade","search","handshakeTimeout","test","has","origin","Origin","username","password","auth","parts","split","_originalIpc","_originalSecure","_originalHostOrSocketPath","entries","toLowerCase","listenerCount","isSameHost","authorization","cookie","res","location","addr","abort","upgrade","digest","update","serverProt","protError","secWebSocketExtensions","extensionNames","finishRequest","servername","isIP","setHeader","bind","receiverOnFinish","read","clearTimeout","finished","property","get","subprotocol","require$$6","keyRegex","server","STATUS_CODES","h","abortHandshakeOrEmitwsClientError","websocketServer","handleProtocols","clientTracking","verifyClient","noServer","backlog","_server","createServer","body","writeHead","listen","emitConnection","_removeListeners","addListeners","listening","handleUpgrade","clients","_shouldEmitClose","shouldHandle","version","secWebSocketProtocol","info","secure","authorized","encrypted","verified","completeUpgrade","readable","writable","ws","next","delete","generateQueryString","query","queryArray","queryObject","queryString","TunnelDevice","routeNamespace","parentRouteNamespace","tunnelId","requestParams","createDevice","fetch","baseURL","JSON","stringify","json","getDeviceById","listDevices","updateDevice","deleteDevice","TunnelPublish","baseUrl","wsHost","TunnelTopic","createTopic","getTopicById","topicId","listTopics","updateTopic","deleteTopic","TunnelApi","apiTunnel","devices","getTunnel","updateTunnel","deleteTunnel","httpPublish","ApiTunnel","apiKey","wsUrl","tunnels","tunnelQuery","URLSearchParams","createTunnel","Api","WebSocketClient"],"mappings":"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","x_google_ignoreList":[9,10,11,12,13,14,15,16,17,18,19,20]}